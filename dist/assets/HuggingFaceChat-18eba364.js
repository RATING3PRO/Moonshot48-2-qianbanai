var ae=Object.defineProperty,re=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var N=(e,o,n)=>o in e?ae(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,l=(e,o)=>{for(var n in o||(o={}))U.call(o,n)&&N(e,n,o[n]);if(M)for(var n of M(o))V.call(o,n)&&N(e,n,o[n]);return e},m=(e,o)=>re(e,le(o));var G=(e,o)=>{var n={};for(var s in e)U.call(e,s)&&o.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&M)for(var s of M(e))o.indexOf(s)<0&&V.call(e,s)&&(n[s]=e[s]);return n};var T=(e,o,n)=>new Promise((s,i)=>{var v=d=>{try{f(n.next(d))}catch(g){i(g)}},u=d=>{try{f(n.throw(d))}catch(g){i(g)}},f=d=>d.done?s(d.value):Promise.resolve(d.value).then(v,u);f((n=n.apply(e,o)).next())});import{g as ie,c as ce,q as $,j as t,i as R,z as L,m as H,n as de,l as pe,C,p as ue,I as ge,h as xe,U as K,V as Z,t as k,W as fe,X as me,Y as ve,T as A,Z as he,_ as ye,$ as Ce,a0 as Ae,K as b,a1 as je,L as Ie,N as Se,a2 as Me}from"./index-5a8bf324.js";import{r as x,R as be}from"./vendor-2240c9f5.js";import{H as P}from"./huggingFaceService-5be892dd.js";import{C as Pe}from"./Close-30b19d23.js";import"./ui-2716f190.js";function Le(e){return ie("MuiAlert",e)}const $e=ce("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Y=$e,Re=$(t.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),we=$(t.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),ze=$(t.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Fe=$(t.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),We=e=>{const{variant:o,color:n,severity:s,classes:i}=e,v={root:["root",`color${H(n||s)}`,`${o}${H(n||s)}`,`${o}`],icon:["icon"],message:["message"],action:["action"]};return xe(v,Le,i)},Ee=R(L,{name:"MuiAlert",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[o.root,o[n.variant],o[`${n.variant}${H(n.color||n.severity)}`]]}})(de(({theme:e})=>{const o=e.palette.mode==="light"?K:Z,n=e.palette.mode==="light"?Z:K;return m(l({},e.typography.body2),{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(k(["light"])).map(([s])=>({props:{colorSeverity:s,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${s}Color`]:o(e.palette[s].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${s}StandardBg`]:n(e.palette[s].light,.9),[`& .${Y.icon}`]:e.vars?{color:e.vars.palette.Alert[`${s}IconColor`]}:{color:e.palette[s].main}}})),...Object.entries(e.palette).filter(k(["light"])).map(([s])=>({props:{colorSeverity:s,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${s}Color`]:o(e.palette[s].light,.6),border:`1px solid ${(e.vars||e).palette[s].light}`,[`& .${Y.icon}`]:e.vars?{color:e.vars.palette.Alert[`${s}IconColor`]}:{color:e.palette[s].main}}})),...Object.entries(e.palette).filter(k(["dark"])).map(([s])=>({props:{colorSeverity:s,variant:"filled"},style:l({fontWeight:e.typography.fontWeightMedium},e.vars?{color:e.vars.palette.Alert[`${s}FilledColor`],backgroundColor:e.vars.palette.Alert[`${s}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[s].dark:e.palette[s].main,color:e.palette.getContrastText(e.palette[s].main)})}))]})})),Te=R("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,o)=>o.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),ke=R("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,o)=>o.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),He=R("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,o)=>o.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),_={success:t.jsx(Re,{fontSize:"inherit"}),warning:t.jsx(we,{fontSize:"inherit"}),error:t.jsx(ze,{fontSize:"inherit"}),info:t.jsx(Fe,{fontSize:"inherit"})},Be=x.forwardRef(function(o,n){const s=pe({props:o,name:"MuiAlert"}),O=s,{action:i,children:v,className:u,closeText:f="Close",color:d,components:g={},componentsProps:w={},icon:j,iconMapping:I=_,onClose:S,role:z="alert",severity:y="success",slotProps:F={},slots:W={},variant:a="standard"}=O,r=G(O,["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"]),p=m(l({},s),{color:d,severity:y,variant:a,colorSeverity:d||y}),h=We(p),c={slots:l({closeButton:g.CloseButton,closeIcon:g.CloseIcon},W),slotProps:l(l({},w),F)},[E,q]=C("root",{ref:n,shouldForwardComponentProp:!0,className:ue(h.root,u),elementType:Ee,externalForwardedProps:l(l({},c),r),ownerState:p,additionalProps:{role:z,elevation:0}}),[X,J]=C("icon",{className:h.icon,elementType:Te,externalForwardedProps:c,ownerState:p}),[Q,ee]=C("message",{className:h.message,elementType:ke,externalForwardedProps:c,ownerState:p}),[B,D]=C("action",{className:h.action,elementType:He,externalForwardedProps:c,ownerState:p}),[te,se]=C("closeButton",{elementType:ge,externalForwardedProps:c,ownerState:p}),[oe,ne]=C("closeIcon",{elementType:Pe,externalForwardedProps:c,ownerState:p});return t.jsxs(E,m(l({},q),{children:[j!==!1?t.jsx(X,m(l({},J),{children:j||I[y]||_[y]})):null,t.jsx(Q,m(l({},ee),{children:v})),i!=null?t.jsx(B,m(l({},D),{children:i})):null,i==null&&S?t.jsx(B,m(l({},D),{children:t.jsx(te,m(l({size:"small","aria-label":f,title:f,color:"inherit",onClick:S},se),{children:t.jsx(oe,l({fontSize:"small"},ne))}))})):null]}))}),De=Be,Ze=()=>{const[e,o]=x.useState([]),[n,s]=x.useState(""),[i,v]=x.useState(!1),[u,f]=x.useState(null),[d,g]=x.useState("正在检查连接..."),[w,j]=x.useState(fe.MODELS.DEFAULT),I=x.useRef(null),S=P.getAvailableModels();x.useEffect(()=>{(()=>T(void 0,null,function*(){try{g("正在检查连接...");const r=yield P.testConnection();f(r.success),g(r.message),r.success&&setTimeout(()=>{o([{role:"assistant",content:`您好！我是基于Hugging Face的AI助手。我可以帮您回答问题、提供信息或者聊天。请问有什么可以帮您的吗？

注意：首次使用某个模型时，可能需要几分钟来加载模型。请耐心等待。`,timestamp:new Date}])},1e3)}catch(r){console.error("测试API连接失败:",r),f(!1),g("无法连接到Hugging Face API，请稍后再试")}}))()},[]);const z=a=>{const r=a.target.value;P.setModel(r),j(r)};x.useEffect(()=>{var a;(a=I.current)==null||a.scrollIntoView({behavior:"smooth"})},[e]);const y=()=>T(void 0,null,function*(){if(!n.trim()||i)return;const a={role:"user",content:n,timestamp:new Date};o(r=>[...r,a]),s(""),v(!0);try{const r=e.filter(c=>c.role==="user"||c.role==="assistant").map(({role:c,content:E})=>({role:c,content:E})),h={role:"assistant",content:yield P.sendMessage(n,r),timestamp:new Date};o(c=>[...c,h])}catch(r){console.error("获取AI回复失败:",r);const p={role:"assistant",content:`很抱歉，我在回复您时遇到了问题：${r instanceof Error?r.message:String(r)}`,timestamp:new Date};o(h=>[...h,p])}finally{v(!1)}}),F=a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),y())},W=a=>a.split(`
`).map((r,p)=>t.jsxs(be.Fragment,{children:[r,t.jsx("br",{})]},p));return t.jsx(me,{title:"Hugging Face AI 聊天",children:t.jsxs(ve,{maxWidth:"md",sx:{py:4,height:"calc(100vh - 100px)",display:"flex",flexDirection:"column"},children:[t.jsx(A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{textAlign:"center",fontWeight:"bold"},children:"Hugging Face AI 聊天"}),u!==null&&t.jsx(De,{severity:u?"success":"error",sx:{mb:2},action:u&&t.jsxs(he,{variant:"outlined",size:"small",sx:{minWidth:180},children:[t.jsx(ye,{children:"选择AI模型"}),t.jsx(Ce,{value:w,label:"选择AI模型",onChange:z,children:S.map(a=>t.jsx(Ae,{value:a.id,children:a.name},a.id))})]}),children:d}),t.jsx(L,{elevation:3,sx:{p:2,mb:2,flexGrow:1,overflowY:"auto",bgcolor:"#f5f5f5",display:"flex",flexDirection:"column"},children:e.length===0&&!i?t.jsx(b,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",opacity:.7},children:t.jsx(A,{variant:"body1",sx:{textAlign:"center"},children:u===!0?"准备好开始聊天了！发送消息开始对话。":"等待连接到AI服务..."})}):t.jsxs(t.Fragment,{children:[e.map((a,r)=>t.jsx(b,{sx:{display:"flex",justifyContent:a.role==="user"?"flex-end":"flex-start",mb:2},children:t.jsxs(L,{elevation:1,sx:{p:2,maxWidth:"80%",bgcolor:a.role==="user"?"#e3f2fd":"#fff",borderRadius:2},children:[t.jsx(A,{variant:"subtitle2",sx:{fontWeight:"bold",mb:.5},children:a.role==="user"?"您":"AI助手"}),t.jsx(A,{variant:"body1",children:W(a.content)}),t.jsx(A,{variant:"caption",sx:{display:"block",mt:1,color:"text.secondary"},children:a.timestamp.toLocaleTimeString()})]})},r)),i&&t.jsx(b,{sx:{display:"flex",justifyContent:"flex-start",mb:2},children:t.jsxs(L,{elevation:1,sx:{p:2,maxWidth:"80%",bgcolor:"#fff",borderRadius:2,display:"flex",alignItems:"center"},children:[t.jsx(je,{size:20,sx:{mr:2}}),t.jsx(A,{variant:"body1",children:"AI正在思考中..."})]})}),t.jsx("div",{ref:I})]})}),t.jsxs(b,{sx:{display:"flex",gap:1},children:[t.jsx(Ie,{fullWidth:!0,variant:"outlined",placeholder:"输入您的问题...",value:n,onChange:a=>s(a.target.value),onKeyPress:F,disabled:!u||i,multiline:!0,maxRows:3,sx:{bgcolor:"#fff"}}),t.jsx(Se,{variant:"contained",color:"primary",endIcon:t.jsx(Me,{}),onClick:y,disabled:!u||i||!n.trim(),sx:{minWidth:"100px"},children:"发送"})]})]})})};export{Ze as default};
